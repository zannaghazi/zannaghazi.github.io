<!DOCTYPE html>
<html>
    <head>
		<title>Demo Scanner</title>
		<link rel="stylesheet" href="css/main.css">
		<link href="css/bootstrap.min.css" rel="stylesheet">
		
		<script src="js/jquery-2.1.1.min.js"></script>
	</head>
	
	<body>
		<div id="QR-Code" class="container" style="width:100%">
			<div class="panel panel-primary">
				<div class="panel-heading" style="display: inline-block;width: 100%;">
                    <h4 style="width:50%;float:left;">WebCodeCam.js Demonstration</h4>
                    <div style="width:50%;float:right;margin-top: 5px;margin-bottom: 5px;text-align: right;">
                    <select id="cameraId" class="form-control" style="display: inline-block;width: auto;"></select>
                    <button id="play" data-toggle="tooltip" title="Play" type="button" class="btn btn-success btn-sm"><span class="glyphicon glyphicon-play"></span></button>
                </div>
			</div>
			<div class="panel-body">
				<div class="col-md-6" style="text-align: center;">
					<div class="well" style="position: relative;display: inline-block;">
                        <canvas id="qr-canvas" width="320" height="240"></canvas>
                        <div class="scanner-laser laser-rightBottom" style="opacity: 0.5;"></div>
                        <div class="scanner-laser laser-rightTop" style="opacity: 0.5;"></div>
                        <div class="scanner-laser laser-leftBottom" style="opacity: 0.5;"></div>
                        <div class="scanner-laser laser-leftTop" style="opacity: 0.5;"></div>
                    </div>
					<div class="well" style="position: relative;" >
                        <label id="zoom-value" width="100">Zoom: 2</label>
                        <input type="range" id="zoom" value="20" min="10" max="30" onchange="Page.changeZoom();"/>
                    </div>
					<div class="caption">
                        <h3>Scanned result</h3>
                        <p id="scanned-QR"></p>
                    </div>
				</div>
				<div class="panel-footer">
				</div>
			</div>
		</div>
	</body>
	<script>
		'use strict';
		var decoder = $('#qr-canvas'),
		scannerLaser = $('.scanner-laser'),
		btnPlay = $('#play'),
		zoomValue = $('#zoom-value'),
		zoom = $('#zoom');
		
		scannerLaser.css('opacity', .5);
		
		btnPlay.click(function(){
			alert("button is clicked");
			
			if(typeof decoder.data().plugin_WebCodeCam === "undefined"){
				decoder.WebCodeCam({
				videoSource: {
					id: $('select#cameraId').val(),
					maxWidth: 640,
					maxHeight: 480
				},
				autoBrightnessValue: 120,
				resultFunction: function(text, imgSrc) {
					sQ.text(text);
					sl.fadeOut(150, function() {
						sl.fadeIn(150);
					});
				},
				getUserMediaError: function() {
					alert('Sorry, the browser you are using doesn\'t support getUserMedia');
				},
				cameraError: function(error) {
					var p, message = 'Error detected with the following parameters:\n';
					for (p in error) {
						message += p + ': ' + error[p] + '\n';
					}
					alert(message);
				}
			}
		});
	</script>	
</html>